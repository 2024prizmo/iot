# 3.1 Лабораторная работа: Начинаем работу с Wi-Fi модулем
## Цель работы
Познакомится с WIFI модулем idw01m1, изучить способы обращения к модулю как к интерфейсу связи посредству работы с встроенными АТ командами. Получить первоначальные навыки работы с терминалом MBED. Получить необходимые навыки работы с платой для ее дальнейшей интеграцией с модулями платы и использованием в будущих проектах курса интернет вещей.
## 3.1.1 Необходимое оборудование
* Плата idw01m1

![](img/idw01m1.jpg)

* Плата STM32Nucleo

![](img/nucleo.png)

* Провод USB для подключения

* Mbed studio для ввода команд

* Точка WIFI с доступом в интернет

### План лабораторной работы   

* Соединяем idw01m1 с STM32Nucleo, проверяем соединение

* Проверяем актуальность прошивки и обновляем ее при необходимости

* Изучаем документацию по (https://www.terraelectronica.ru/rd/ST/X-NUCLEO-IDW01M1)

## 3.1.2 Коммуникация через последовательный порт, AT команды
### Что ткое AT команды и для чего они нужны?
AT-команды — набор команд, разработанных в 1977 году компанией Hayes для собственной разработки, модема «Smartmodem 300 baud». Набор команд состоит из серий коротких текстовых строк, которые объединяют вместе, чтобы сформировать полные команды операций, таких как набор номера, начала соединения или изменения параметров подключения.

AT-команды обычно отправляются модему посредством коммуникационного программного обеспечения, но также могут быть введены пользователем вручную, с компьютерной клавиатуры.

АТ команды:

* можно вызывать вручную посредством обращения в терминал MBED

* вызываются автоматически когда мы запускаем программу для раюоты с интернет сетью(при вызове команды запускаются в библиотеке mbed.h)

Документация по АТ командам для платы idw01m1
(https://www.st.com/resource/en/user_manual/dm00241943-getting-started-with-the-xcubewifi1-wifi-functions-and-applications-software-expansion-for-stm32cube-stmicroelectronics.pdf)

### Работа с терминалом MBED

Рассмотрим пример с использованием АТ команд на примере платы ESP8266

Запустите терминал 

![](img/terminal.jpg)

![](img/termina2.PNG)

Введите вначале команду AT - в ответ получите ответ OK. Если ошибетесь и введете несуществующую команду, плата выдаст ответ ERROR. Каждую команду завершайте следующими символами: возврат каретки (CTRL+M) и перенос строки (CTRL+J). Это те самые, которые в ASCII имеют коды \n и \r.

Ввода команды AT+GMR - информацию о плате. 

![](img/termina3.png)

Синтаксис АТ команд на разных платах отличается, у каждой платы он уникален(см документацию по плате)
------
Как пример
------
Плата ESP8266 команда для подключиться к точке доступа

```C
AT+CWJAP="my-test-wifi","1234test".
```
Плата SPWF01SA11 команда для подключиться к точке доступа

```C
AT+S.SSIDTXT=my-test-wifi 
AT+S.SCFG=wifi_wpa_psk_text,1234test
```

## 3.1.3. Обновление прошивки платы

Полезная информация по поводу платы расширения X-NUCLEO-IDW01M1 на основе WiFi модуля SWPF01SA(https://www.terraelectronica.ru/news/4715)

Самая новая версия прошивки - перейдите на сайт выбирите, Tools & Software и скачайте ее
(https://www.st.com/content/st_com/en/products/ecosystems/stm32-open-development-environment/stm32-nucleo-expansion-boards/stm32-ode-connect-hw/x-nucleo-idw01m1.html#tools-software). 

После установки перезагрузите компьютер.

## 3.1.4. Примеры AT-команд

Давайте теперь посмотрим ещё какую-нибудь информацию из модуля.

Посмотрим конфигурацию с помощью команды "AT&V"

![](img/rez.png)

Информации много, поэтому я всю показывать не стал, увидите сами. В том числе мы видим здесь mac-адрес модуля.

Теперь посмотрим статусы с помощью команды "AT+S.STS"

![](img/2.png)

Здесь мы также видим версию прошивки и уже MAC-адрес точки доступа


Запросим ещё некоторую важную информацию по работе модуля в сети Wi-Fi с помощью команды "AT+S.PEERS"

Одним из немаловажных параметров это уровень сигнала от точки доступа в децибелах (выделено синим прямоугольником)

![](img/3.png)
